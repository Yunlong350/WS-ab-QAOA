import numpy as np
import matplotlib.pyplot as plt


GW=np.zeros((11,40))
ab=np.zeros((11,40))
bias=np.zeros((11,40))

 
#n=1000 R=1 seed=10
GW[0]=np.array([1336., 1326., 1329., 1333., 1327., 1324., 1321., 1336., 1318.,
       1325., 1337., 1331., 1323., 1338., 1333., 1331., 1336., 1319.,
       1325., 1332., 1325., 1325., 1339., 1331., 1345., 1322., 1325.,
       1322., 1339., 1329., 1338., 1327., 1332., 1329., 1331., 1331.,
       1331., 1317., 1328., 1323.])
ab[0]=np.array([1363.99243588, 1351.99769368, 1358.99176988, 1360.99703068,
       1359.9973483 , 1358.99246979, 1348.99726018, 1358.99746484,
       1356.99734768, 1360.99727787, 1366.99729585, 1359.9926254 ,
       1365.99332189, 1362.99204575, 1364.99266275, 1362.99245431,
       1369.9920454 , 1356.99714018, 1362.99232448, 1363.99709487,
       1361.99680423, 1359.99739573, 1367.99249354, 1358.99710453,
       1364.99234342, 1358.9968629 , 1361.99373329, 1359.99308219,
       1368.99194619, 1363.99723486, 1363.99761927, 1360.99712726,
       1361.99228921, 1363.99725285, 1357.99750699, 1364.99751867,
       1368.99277951, 1358.99369617, 1364.9927173 , 1356.99754593])
bias[0]=np.array([1364., 1352., 1359., 1361., 1360., 1359., 1349., 1359., 1357.,
       1361., 1367., 1360., 1366., 1363., 1365., 1363., 1370., 1357.,
       1363., 1364., 1362., 1360., 1368., 1359., 1365., 1359., 1362.,
       1360., 1369., 1364., 1364., 1361., 1362., 1364., 1358., 1365.,
       1369., 1359., 1365., 1357.])

#seed=10+R
#n=1000 R=5
GW[1]=np.array([1336., 1337., 1337., 1339., 1338., 1350., 1333., 1338., 1338.,
       1350., 1342., 1328., 1344., 1345., 1349., 1331., 1338., 1330.,
       1354., 1344., 1347., 1344., 1353., 1341., 1337., 1342., 1330.,
       1339., 1341., 1340., 1343., 1333., 1343., 1346., 1337., 1340.,
       1337., 1336., 1340., 1347.])
ab[1]=np.array([1363.99243588, 1365.99193689, 1367.99736884, 1369.99308581,
       1362.99310147, 1370.99157589, 1364.99241857, 1361.99740815,
       1366.99245651, 1365.992021  , 1369.99252307, 1362.99305534,
       1371.99246509, 1370.99220857, 1376.99254471, 1368.99252641,
       1363.99157026, 1364.99280261, 1374.99193163, 1375.992989  ,
       1371.99224225, 1368.99182196, 1366.99138779, 1360.99759337,
       1364.99174657, 1368.99196674, 1358.9971797 , 1364.99224485,
       1369.99190067, 1373.99273739, 1366.99230449, 1365.99693103,
       1362.99754752, 1370.99758126, 1367.99702659, 1371.99715562,
       1359.9972001 , 1363.99253094, 1360.99246161, 1370.9977905 ])
bias[1]=np.array([1364., 1366., 1368., 1370., 1363., 1371., 1365., 1362., 1367.,
       1366., 1370., 1363., 1372., 1371., 1377., 1369., 1364., 1365.,
       1375., 1376., 1372., 1369., 1367., 1361., 1365., 1369., 1359.,
       1365., 1370., 1374., 1367., 1366., 1363., 1371., 1368., 1372.,
       1360., 1364., 1361., 1371.])

#n=1000 R=10
GW[2]=np.array([1340., 1337., 1341., 1337., 1348., 1346., 1339., 1346., 1337.,
       1343., 1356., 1337., 1345., 1336., 1340., 1335., 1344., 1338.,
       1345., 1343., 1343., 1342., 1337., 1334., 1343., 1337., 1333.,
       1345., 1341., 1343., 1341., 1345., 1339., 1343., 1342., 1340.,
       1351., 1346., 1342., 1337.])
ab[2]=np.array([1364.99243748, 1365.99231792, 1362.99271566, 1363.99166186,
       1372.99147181, 1375.99240373, 1369.99289693, 1364.99750381,
       1364.99285898, 1363.99757043, 1376.99201104, 1363.99259667,
       1370.99252774, 1366.99260971, 1364.99196888, 1360.99736288,
       1370.99222777, 1370.99274714, 1376.99226811, 1376.99300661,
       1365.99773312, 1364.99124458, 1361.99747814, 1365.99234963,
       1370.99268898, 1366.9971766 , 1361.99745437, 1364.99195428,
       1369.99703602, 1365.99765019, 1367.992089  , 1364.99724721,
       1360.99124886, 1371.99146629, 1369.99129026, 1363.99176327,
       1369.99202639, 1368.99206303, 1365.99227135, 1368.99208826])
bias[2]=np.array([1365., 1366., 1363., 1364., 1373., 1376., 1370., 1365., 1365.,
       1364., 1377., 1364., 1371., 1367., 1365., 1361., 1371., 1371.,
       1377., 1377., 1366., 1365., 1362., 1366., 1371., 1367., 1362.,
       1365., 1370., 1366., 1368., 1365., 1361., 1372., 1370., 1364.,
       1370., 1369., 1366., 1369.])

#n=1000 R=15
GW[3]=np.array([1345., 1336., 1350., 1335., 1348., 1344., 1343., 1344., 1338.,
       1338., 1344., 1340., 1340., 1341., 1342., 1342., 1353., 1334.,
       1341., 1351., 1344., 1338., 1337., 1334., 1345., 1339., 1350.,
       1343., 1347., 1343., 1350., 1347., 1340., 1338., 1341., 1353.,
       1343., 1336., 1346., 1355.])
ab[3]=np.array([1365.99189347, 1370.99334243, 1369.99101797, 1364.99287814,
       1369.99721201, 1366.99710603, 1364.99168211, 1369.99190625,
       1363.99746506, 1369.99290195, 1367.99061674, 1372.99270591,
       1364.99740836, 1371.99215402, 1365.9976345 , 1367.99167069,
       1372.99140686, 1364.99740814, 1368.99230711, 1370.99126981,
       1373.99698377, 1367.99728341, 1365.99284133, 1358.99761955,
       1368.99731506, 1361.99761777, 1365.99740859, 1371.99286512,
       1363.99753261, 1370.99708164, 1369.99720431, 1370.99619824,
       1368.99244226, 1363.9978169 , 1365.99752972, 1374.99207644,
       1364.99740321, 1363.99186315, 1366.99171784, 1371.99179733])
bias[3]=np.array([1366., 1371., 1370., 1365., 1370., 1367., 1365., 1370., 1364.,
       1370., 1368., 1373., 1365., 1372., 1366., 1368., 1373., 1365.,
       1369., 1371., 1374., 1368., 1366., 1359., 1369., 1362., 1366.,
       1372., 1364., 1371., 1370., 1371., 1369., 1364., 1366., 1375.,
       1365., 1364., 1367., 1372.])

#n=1000 R=20
GW[4]=np.array([1345., 1341., 1343., 1337., 1338., 1346., 1339., 1342., 1346.,
       1345., 1347., 1342., 1346., 1344., 1341., 1346., 1350., 1341.,
       1345., 1346., 1343., 1347., 1337., 1338., 1348., 1348., 1348.,
       1347., 1348., 1344., 1344., 1340., 1342., 1351., 1341., 1351.,
       1342., 1343., 1339., 1353.])
ab[4]=np.array([1365.99189347, 1368.9923608 , 1370.99275143, 1364.99308988,
       1361.99205086, 1373.99736594, 1366.99273777, 1365.99193894,
       1364.9919699 , 1368.99751853, 1367.99709124, 1369.99293972,
       1372.99258241, 1371.99185653, 1358.9974754 , 1372.99271764,
       1378.99219766, 1373.99247758, 1375.9919137 , 1367.99746928,
       1367.99185447, 1370.99248145, 1357.99773288, 1362.9930503 ,
       1366.99761512, 1366.99094408, 1365.99751561, 1368.99761064,
       1374.99225788, 1362.99754705, 1369.99200606, 1367.99251807,
       1367.99235467, 1370.99722953, 1361.9915502 , 1368.99712414,
       1362.99731875, 1367.99751524, 1362.99126287, 1373.99204732])
bias[4]=np.array([1366., 1369., 1371., 1365., 1362., 1374., 1367., 1366., 1365.,
       1369., 1368., 1370., 1373., 1372., 1359., 1373., 1379., 1374.,
       1376., 1368., 1368., 1371., 1358., 1363., 1367., 1367., 1366.,
       1369., 1375., 1363., 1370., 1368., 1368., 1371., 1362., 1369.,
       1363., 1368., 1363., 1374.])


#n=1000 R=25
GW[5]=np.array([1345., 1343., 1350., 1344., 1346., 1347., 1344., 1342., 1345.,
       1346., 1349., 1340., 1346., 1340., 1352., 1343., 1350., 1339.,
       1358., 1346., 1346., 1339., 1342., 1348., 1347., 1340., 1341.,
       1339., 1337., 1340., 1342., 1347., 1340., 1341., 1340., 1346.,
       1340., 1343., 1342., 1346.])
ab[5]=np.array([1365.99189347, 1360.99777544, 1366.9972892 , 1360.99155501,
       1369.99274856, 1369.99747702, 1367.99258647, 1359.99250797,
       1365.99152869, 1364.99204463, 1369.99738059, 1362.99745137,
       1369.99207801, 1367.99249768, 1370.99152181, 1366.99215812,
       1368.99748365, 1358.99131929, 1379.99237731, 1362.99700682,
       1369.99717461, 1364.99739707, 1369.99284908, 1368.9920527 ,
       1367.99083583, 1363.99730121, 1367.99151575, 1360.99755958,
       1363.99286842, 1366.99198798, 1366.99148676, 1370.99200371,
       1368.99241539, 1368.99244186, 1363.99257961, 1371.99206228,
       1365.99216046, 1369.99192546, 1361.9975276 , 1373.99259128])
bias[5]=np.array([1366., 1361., 1367., 1361., 1370., 1370., 1368., 1360., 1366.,
       1365., 1370., 1363., 1370., 1368., 1371., 1367., 1369., 1359.,
       1380., 1363., 1370., 1365., 1370., 1369., 1368., 1364., 1368.,
       1361., 1364., 1367., 1367., 1371., 1369., 1369., 1364., 1372.,
       1366., 1370., 1362., 1374.])


#n=1000 R=30
GW[6]=np.array([1345., 1343., 1350., 1344., 1346., 1346., 1343., 1342., 1340.,
       1348., 1352., 1345., 1346., 1344., 1342., 1344., 1353., 1346.,
       1347., 1354., 1354., 1345., 1339., 1340., 1345., 1340., 1344.,
       1339., 1345., 1346., 1346., 1345., 1345., 1340., 1344., 1343.,
       1341., 1347., 1349., 1349.])
ab[6]=np.array([1365.99189347, 1360.99777544, 1366.9972892 , 1360.99155501,
       1372.99237591, 1375.99239005, 1367.99235666, 1365.99246649,
       1363.99145436, 1374.99238963, 1370.99723232, 1368.99294686,
       1364.99188445, 1361.99732834, 1368.99222509, 1364.99198829,
       1378.99173053, 1372.9925873 , 1374.9924446 , 1371.99177284,
       1378.99189589, 1366.9974879 , 1363.99252509, 1364.99158336,
       1368.99202912, 1365.99695213, 1366.99183007, 1365.99173665,
       1366.99158743, 1364.99208036, 1366.99766283, 1368.99218013,
       1372.99269938, 1362.99750044, 1365.99163576, 1366.99219943,
       1368.99224705, 1367.99222797, 1364.99754164, 1372.99207212])
bias[6]=np.array([1366., 1361., 1367., 1361., 1373., 1376., 1368., 1366., 1364.,
       1375., 1371., 1369., 1365., 1362., 1369., 1365., 1379., 1373.,
       1375., 1372., 1379., 1367., 1364., 1365., 1369., 1366., 1367.,
       1366., 1367., 1365., 1367., 1369., 1373., 1363., 1366., 1367.,
       1369., 1368., 1365., 1373.])


#n=1000 R=35
GW[7]=np.array([1345., 1343., 1348., 1344., 1349., 1343., 1341., 1337., 1339.,
       1345., 1343., 1343., 1342., 1354., 1342., 1339., 1344., 1345.,
       1354., 1346., 1359., 1345., 1340., 1345., 1345., 1339., 1347.,
       1342., 1347., 1340., 1341., 1347., 1345., 1352., 1345., 1351.,
       1349., 1348., 1342., 1354.])
ab[7]=np.array([1365.99189347, 1360.99777544, 1371.9916765 , 1367.99244809,
       1373.99252971, 1373.99285986, 1367.99266   , 1362.99735111,
       1364.99721589, 1369.99164211, 1366.99211251, 1368.99155948,
       1368.99222671, 1371.99745738, 1365.99190239, 1368.99292837,
       1371.99234325, 1370.99284351, 1376.99723081, 1365.99174048,
       1375.99079424, 1370.9916578 , 1369.99254914, 1372.99251393,
       1367.99235617, 1365.99752783, 1370.99221267, 1368.99276806,
       1368.9970179 , 1365.99234724, 1370.99240257, 1370.99245085,
       1368.99746395, 1372.99159614, 1363.99162345, 1370.99197965,
       1367.99124486, 1370.99736452, 1364.99196868, 1372.99093749])
bias[7]=np.array([1366., 1361., 1372., 1368., 1374., 1374., 1368., 1363., 1365.,
       1370., 1367., 1369., 1369., 1372., 1366., 1369., 1372., 1371.,
       1377., 1366., 1376., 1371., 1370., 1373., 1368., 1366., 1371.,
       1369., 1369., 1366., 1371., 1371., 1369., 1373., 1364., 1371.,
       1368., 1371., 1365., 1373.])

#n=1000 R=40
GW[8]=np.array([1345., 1343., 1348., 1344., 1349., 1349., 1347., 1340., 1347.,
       1347., 1350., 1358., 1341., 1346., 1349., 1346., 1344., 1337.,
       1356., 1348., 1352., 1351., 1346., 1342., 1345., 1344., 1349.,
       1347., 1344., 1346., 1345., 1347., 1346., 1348., 1346., 1354.,
       1341., 1341., 1343., 1347.])
ab[8]=np.array([1365.99189347, 1360.99777544, 1371.9916765 , 1367.99244809,
       1373.99252971, 1371.99187315, 1365.99163815, 1362.99198012,
       1369.99190898, 1371.99264848, 1370.99262629, 1374.99170071,
       1366.9911014 , 1369.99237413, 1373.99219608, 1362.99757629,
       1362.99757479, 1366.9917229 , 1376.99725881, 1367.99197931,
       1372.99111124, 1370.9921414 , 1371.99198342, 1363.99729369,
       1363.997639  , 1372.9929657 , 1374.99196903, 1366.99190034,
       1368.99746734, 1370.99214341, 1364.99726802, 1368.99200464,
       1365.99758321, 1366.99738537, 1369.99154035, 1367.9912549 ,
       1366.99230103, 1368.99112918, 1368.99164709, 1369.99748352])
bias[8]=np.array([1366., 1361., 1372., 1368., 1374., 1372., 1366., 1363., 1370.,
       1372., 1371., 1375., 1367., 1370., 1374., 1363., 1363., 1367.,
       1377., 1368., 1373., 1371., 1372., 1364., 1364., 1373., 1375.,
       1367., 1369., 1371., 1365., 1369., 1366., 1367., 1370., 1368.,
       1367., 1369., 1369., 1370.])

#n=1000 R=45
GW[9]=np.array([1345., 1343., 1347., 1341., 1346., 1349., 1347., 1339., 1350.,
       1346., 1351., 1347., 1340., 1348., 1351., 1345., 1354., 1341.,
       1356., 1345., 1355., 1348., 1346., 1342., 1349., 1342., 1347.,
       1338., 1348., 1345., 1345., 1346., 1347., 1348., 1343., 1342.,
       1350., 1342., 1348., 1344.])
ab[9]=np.array([1365.99189347, 1360.99777544, 1372.99289815, 1363.99243695,
       1365.99192915, 1371.99187315, 1365.99163815, 1362.99740763,
       1365.99730962, 1373.9926328 , 1367.99755302, 1368.99758397,
       1368.99711463, 1364.99774785, 1370.99222031, 1363.99748559,
       1369.99734298, 1359.99149412, 1379.99166488, 1369.99228505,
       1377.99197721, 1371.99289394, 1367.99231779, 1365.9922999 ,
       1365.99762054, 1364.99745867, 1366.99162196, 1365.99286365,
       1368.99210761, 1368.99153382, 1372.9923982 , 1373.99218873,
       1370.99676753, 1369.99747726, 1371.99261939, 1368.99767193,
       1370.99748195, 1358.99761525, 1368.99164481, 1367.99755204])
bias[9]=np.array([1366., 1361., 1373., 1364., 1366., 1372., 1366., 1363., 1366.,
       1374., 1368., 1369., 1369., 1365., 1371., 1364., 1370., 1360.,
       1380., 1370., 1378., 1372., 1368., 1366., 1366., 1365., 1367.,
       1366., 1369., 1369., 1373., 1374., 1371., 1370., 1372., 1369.,
       1371., 1359., 1369., 1368.])

#n=1000 R=50
GW[10]=np.array([1345., 1342., 1343., 1337., 1346., 1349., 1342., 1339., 1347.,
       1350., 1347., 1342., 1343., 1349., 1349., 1345., 1353., 1348.,
       1352., 1342., 1353., 1350., 1338., 1347., 1351., 1344., 1348.,
       1343., 1351., 1343., 1347., 1346., 1345., 1346., 1352., 1349.,
       1341., 1341., 1342., 1348.])
ab[10]=np.array([1365.99189347, 1364.99207932, 1369.99276825, 1360.99136437,
       1365.99192915, 1370.99207735, 1364.9975793 , 1362.99740763,
       1368.9926605 , 1366.99756994, 1367.99690964, 1371.99307803,
       1367.99766596, 1367.99115214, 1369.99245642, 1369.99209022,
       1379.99165089, 1365.99724668, 1382.99190256, 1363.99718139,
       1379.99217853, 1370.99210906, 1364.9921312 , 1371.99191957,
       1371.99188967, 1363.99754157, 1370.99727723, 1364.99736532,
       1371.99194943, 1360.99736131, 1367.99251607, 1373.99185794,
       1369.99094906, 1366.99111776, 1369.99157603, 1367.9976757 ,
       1366.99768596, 1368.99275869, 1369.99244697, 1369.99118293])
bias[10]=np.array([1366., 1365., 1370., 1361., 1366., 1371., 1365., 1363., 1369.,
       1367., 1368., 1372., 1368., 1368., 1370., 1370., 1380., 1366.,
       1383., 1364., 1380., 1371., 1365., 1372., 1372., 1364., 1371.,
       1365., 1372., 1361., 1368., 1374., 1370., 1367., 1370., 1368.,
       1367., 1369., 1370., 1370.])



GW_best=np.zeros((11,40))

bias_best=np.zeros((11,40))


for i in range(11):
    for j in range(40):
        
        a=GW[:,j][:i+1]
        
        p=np.where(a==np.max(a))[0][0]
        
        GW_best[i][j]=a[p]
        bias_best[i][j]=bias[:,j][:i+1][p]
        
    

        
R=np.array([0]+[5*i for i in range(1,11)])  

Rs=[np.sum(R[:i]) for i in range(1,12) ]

fig,ax=plt.subplots()

b1,=ax.plot(Rs,np.mean(GW_best,axis=1)/1500,color='#2673EF',marker='o',linestyle='-',label=r'$N_\mathrm{cut}^\mathrm{GW}/|\mathcal{E}|$')
b2,=ax.plot(Rs,np.mean(bias_best,axis=1)/1500,color='#CD5257',marker='v',linestyle='-',label=r'$N_\mathrm{cut}^\mathrm{bias}/|\mathcal{E}|$')
#b2,=ax.plot(n_list,np.mean(GW,axis=1)-np.mean(e[:,1],axis=1),color='C2',marker='v',linestyle='-')



ax.set_xlabel(r'$R$',fontsize=14)
ax.set_ylabel(r'$N_\mathrm{cut}^\mathrm{alg}/|\mathcal{E}|$',fontsize=14)
#ax.set_xticks(Rs)
ax.legend(prop={'size': 13})
plt.yticks([0.88,0.89,0.9,0.91,0.92])
plt.tick_params(labelsize='12')
plt.savefig('Fig_gwab.pdf',format='pdf',dpi=1200,bbox_inches='tight')
plt.show()

